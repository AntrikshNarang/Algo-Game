(()=>{var e={730:e=>{class a{constructor(e,a){this.number=e,this.color=a}getColor(){return this.color}getNumber(){return this.number}setNumber(e){this.number=e}setColor(e){this.color=e}generateRandomNumber(e=0,a){return Math.floor(Math.random()*(a-e)+e)}isCorrectGuess(e){return e===this.number}}function s(e){for(var a=e.length-1;a>0;a--)j=Math.floor(Math.random()*a),[e[a],e[j]]=[e[j],e[a]];return e}e.exports={AlgoCard:a,shuffle:s,getShuffledDeck:function(e){deck=[];for(var o=0;o<e/2;o++){var t=new a(o,"black");deck.push(t)}for(o=0;o<e/2;o++)t=new a(o,"white"),deck.push(t);return s(deck)},removeNums:function(e){var a=e;for(i=0;i<a.length;i++)a[i].setNumber(null);return a},sortPlayerHand:function(e){return e.sort(((e,a)=>e.getColor()!==a.getColor()&&e.getNumber()===a.getNumber()?"black"===e.getColor()?-1:1:e.getNumber()-a.getNumber())),e},ObjectArray_to_AlgoCardArray:function(e){for(var s=0;s<e.length;s++)e[s]=new a(e[s].number,e[s].color);return e},deepCopy:function(e){return JSON.parse(JSON.stringify(e))}}}},a={};function s(o){var t=a[o];if(void 0!==t)return t.exports;var r=a[o]={exports:{}};return e[o](r,r.exports,s),r.exports}s.d=(e,a)=>{for(var o in a)s.o(a,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})},s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a);var o={};(()=>{"use strict";s.d(o,{l:()=>L});var e=s(730);const a=$("#dealt-card"),t=$(".attack"),r=$(".hold"),n=$(".game-result"),l=$(".modal-game-result");function d(e){return"black"==e?"white":"black"}function c(e){const s=e.getNumber(),o=e.getColor();null!==s?a.html(s):a.html(""),a.removeClass(d(o)),a.addClass(o)}function m(){t.click((()=>{L.myTurn&&L.socket.emit("attackMove",{guessTarget:L.selectedCard,guessValue:L.myGuessValue})})),r.click((()=>{L.myTurn&&L.socket.emit("holdMove")}))}const i=$("#guess-count"),u=$("#correct-guesses"),y=$("#guess-rate"),C=$("#stay-count"),f=$("#my-win-count"),g=$("#enemy-win-count"),p=$("#my-counter"),h=$("#enemy-counter"),v=$("#my-username"),k=$("#enemy-username"),b=$(".enemy-hand-container"),w=$(".guess-array"),T=$(".decision-wrapper");function x(){v.removeClass("player-turn"),k.addClass("player-turn"),b.addClass("no-pointer-events"),w.addClass("guess-array-inactive"),a.removeClass("highlight-dealt-card"),T.addClass("decision-fade-away"),t.addClass("decision-inactive"),r.addClass("decision-inactive")}function A(){v.addClass("player-turn"),k.removeClass("player-turn"),b.removeClass("no-pointer-events"),w.removeClass("guess-array-inactive"),a.addClass("highlight-dealt-card"),T.removeClass("decision-fade-away")}function N(e){$(e).removeClass("selected")}function G(e){e?(n.html("YOU WIN"),n.addClass("game-won")):(n.html("YOU LOSE"),n.addClass("game-lost")),l.removeClass("display-none"),setTimeout((()=>{l.addClass("modal-in"),function(e){const a=Date.now()+8e3;let s=["#ffffff"],o=0,t=-30,r=-150;e?(s.push("#00bb00"),s.push("#e0c331")):(s.push("#bb0000"),s.push("#ff7575"),o=.9,t=60,r=120),function e(){confetti({zIndex:999,particleCount:2,angle:t,spread:60,origin:{x:0,y:o},colors:s,startVelocity:90}),confetti({zIndex:999,particleCount:2,angle:r,spread:60,origin:{x:1,y:o},colors:s,startVelocity:90}),Date.now()<a&&requestAnimationFrame(e)}()}(e)}),1600)}var V=void 0,Y=void 0,O=void 0;function j(e){$(".hold").addClass("decision-inactive"),setTimeout((()=>{e.addClass("correct")}),600),setTimeout((()=>{O.play()}),800),setTimeout((()=>{e.removeClass("correct")}),1200)}function M(e,a){$(a).removeClass("selected"),$(a).addClass(e),setTimeout((()=>{$(a).removeClass(e)}),400)}function D(e,a,s,o){const t=function(e,a){const s=$("<div>");return s.addClass("card"),s.addClass(a),s.addClass(e.getColor()),s.html(e.getNumber()),s}(e,o);!function(e,a,s){const o=$(`.${s}-card`),t=o.length;if(e.addClass(`${s}-card`),a===t){let a=$("#my-hand");"enemy"===s&&(a=$("#enemy-hand")),a.append(e)}else $(o[a]).before(e)}(t,a,s),"enemy"===s&&function(e){const a=$(".enemy-card");for(let s=e;s<a.length;s++){const e=$(a[s]);e.hasClass("open")?e.off("click"):e.click((()=>{L.myTurn&&($($(".enemy-card")[L.selectedCard]).removeClass("selected"),e.addClass("selected"),L.selectedCard=s,L.socket.emit("selectCard",{guessTarget:L.selectedCard}),S.removeClass("decision-inactive"))}))}}(a),async function(e,a){const s=$("#dealt-card").offset(),o=e.offset(),t={Y:s.top-o.top,X:s.left-o.left};(async function(e,a,s){e.hasClass("my-card")||e.hasClass("closed")?$.keyframe.define({name:`draw-${a.getColor()}-${a.getNumber()}`,"100%":{transform:`translate(${s.X}px, ${s.Y}px ) `}}):$.keyframe.define([{name:`draw-${a.getColor()}-${a.getNumber()}`,"0%":{color:`${d(a.getColor())}`,transform:"rotateY(0deg)"},"49%":{color:`${a.getColor()}`},"100%":{transform:`translate(${s.X}px, ${s.Y}px ) rotateY(180deg)`,color:`${a.getColor()}`}}])})(e,a,t).then((()=>{e.playKeyframe({name:`draw-${a.getColor()}-${a.getNumber()}`,duration:"0.4s",timingFunction:"ease",delay:"0s",direction:"reverse",fillMode:"both",complete:function(){e.css({"z-index":"10"})}})}))}(t,e)}const S=$(".attack");function H(e){const a=$(".enemy-card")[e];$(a).off("click"),$(a).addClass("no-pointer-events")}let I;function _(){I.remove(),L.calloutActive=!1}var F=[],z=[],K=0,L={username:void 0,socket:void 0,myTurn:void 0,ready:!1,deckTop:void 0,selectedCard:0,myGuessValue:0,calloutActive:!1};$(document).ready((function(){const a=$("#ready-button"),s=$(".attack"),o=$(".hold"),t=$("#me"),r=$("#enemy");let n=r.html();const d=$("#ready-count"),v=$("#room-key").html();L.username=$("#me").html(),1==parseInt(d.html())&&r.addClass("player-ready"),window.history.pushState(null,"",`/${v}/play`),async function(){$.keyframe.define({name:"flip-white-card","0%":{transform:"rotateY(180deg)",color:"white"},"30%":{color:"white"},"31%":{color:"black"},"100%":{transform:"rotateY(0deg)"}}),$.keyframe.define({name:"flip-black-card","0%":{transform:"rotateY(180deg)",color:"black"},"30%":{color:"black"},"31%":{color:"white"},"100%":{transform:"rotateY(0deg)"}}),$.keyframe.define({name:"hover-callout","0%":{transform:"translate(calc(5.5vh - 50%), -110%)"},"50%":{transform:"translate(calc(5.5vh - 50%), -140%)"},"100%":{transform:"translate(calc(5.5vh - 50%), -110%)"}})}(),V=new Howl({src:["/sounds/ding.ogg"]}),Y=new Howl({src:["/sounds/wrong.ogg"]}),O=new Howl({src:["/sounds/win.ogg"]}),setTimeout((()=>{$("header").removeClass("header-out"),$("footer").removeClass("footer-out"),$(".lobby").removeClass("fade-out")}),200),L.socket=io({query:{username:L.username,roomKey:v}}),L.socket.on("disconnect",(()=>{window.location.href=window.location.href})),L.socket.on("lobbyUpdate",(e=>{const a=e.usernames;n=function(e){let a=e[0];if(a===L.username&&(a=e[1]),null!==a)return $("#enemy").html(a),$("#enemy-username").html(a),$("#enemy-user-hth").html(a),a;$("#enemy").html("...")}(a)})),L.socket.on("readyUpdate",(e=>{d.html(e.readyCount);var s=e.userList[0];if(1!==e.userList.length){var o=e.userList[1];s.username!==L.username&&([s,o]=[o,s]),o.ready?r.addClass("player-ready"):r.removeClass("player-ready")}else r.removeClass("player-ready");s.ready?(t.addClass("player-ready"),a.addClass("ready-status")):(t.removeClass("player-ready"),a.removeClass("ready-status"))})),L.socket.on("startGame",(a=>{$(".lobby").addClass("fade-out"),$(".desk-wrapper").removeClass("display-none"),setTimeout((()=>{$("header").addClass("header-out"),$("footer").addClass("footer-out")}),1e3),setTimeout((()=>{$(".main-bg").removeClass("fade-in")}),1500),setTimeout((()=>{$(".lobby").addClass("display-none"),$("header").addClass("display-none"),$("footer").addClass("display-none"),$("#ready-button").removeClass("ready-status"),$(".desk-wrapper").addClass("fade-in"),L.ready=!1,$("#enemy").removeClass("player-ready"),$("#me").removeClass("player-ready"),$("#ready-count").html("0")}),2300),L.myTurn=a.yourTurn,L.deckTop=new e.AlgoCard(a.deckTop.number,a.deckTop.color),c(L.deckTop),$("#my-hand").html(""),$("#enemy-hand").html(""),F=(0,e.ObjectArray_to_AlgoCardArray)(a.yourHand),z=(0,e.ObjectArray_to_AlgoCardArray)(a.enemyHand),function(e,a){for(let a=0;a<e.length;a++)D(e[a],a,"my","closed");for(let e=0;e<a.length;e++)D(a[e],e,"enemy","closed")}(F,z),L.myTurn?A():x()})),L.socket.on("highlightCard",(e=>{var a,s,o;!function(e){let a=$(".my-card");$(a[L.selectedCard]).removeClass("selected"),L.selectedCard=e,$(a[L.selectedCard]).addClass("selected")}(e.index),a=L.selectedCard,s=F[L.selectedCard].getColor(),o=K,L.myTurn||(L.calloutActive&&I.remove(),I=$("<div>"),I.addClass("guess-callout"),I.addClass(s),I.html(o),$($(".my-card")[a]).prepend(I),L.calloutActive=!0,I.playKeyframe({name:"hover-callout",duration:"2s",timingFunction:"cubic-bezier(.48,.01,.49,.99)",iterationCount:"infinite"}))})),L.socket.on("updateButtonValue",(e=>{var a;a=K=e.buttonValue,I.html(a)})),L.socket.on("correctMove",(e=>{L.myTurn=e.yourTurn;var a=e.guessTarget,t=$(".enemy-card");let r=$(".my-card");V.play(),L.myTurn?(M("correct",t[a]),$(t[a]).html(L.myGuessValue),$(t[a]).addClass("open"),s.addClass("decision-inactive"),o.removeClass("decision-inactive"),H(a),function(e,a){e.playKeyframe({name:`flip-${a.getColor()}-card`,duration:"0.4s",timingFunction:"ease",delay:"0s"})}($(t[a]),z[a])):($(r[a]).removeClass("closed"),$(r[a]).addClass("open"),M("correct",r[a]))})),L.socket.on("wrongMove",(a=>{const s=new e.AlgoCard(a.nextDeckTop.number,a.nextDeckTop.color),o=a.insertIndex;let t=L.deckTop;L.myTurn=a.yourTurn,Y.play(),L.myTurn?(M("wrong",$(".my-card")[L.selectedCard]),t.setNumber(a.value),z.splice(o,0,t),D(t,o,"enemy","open"),H(o),_(),A()):(M("wrong",$(".enemy-card")[L.selectedCard]),F.splice(o,0,t),D(t,o,"my","open"),x()),c(s),L.deckTop=s})),L.socket.on("cardHeld",(a=>{const s=new e.AlgoCard(a.nextDeckTop.number,a.nextDeckTop.color),o=a.insertIndex,t=L.deckTop;L.myTurn=a.yourTurn,L.myTurn?(z.splice(o,0,t),D(t,o,"enemy","closed"),_(),N($(".my-card")[L.selectedCard]),A()):(F.splice(o,0,t),D(t,o,"my","open"),function(e,a){const s=$($(".my-card")[e]);setTimeout((()=>{s.addClass("closed"),s.removeClass("open")}),500)}(o),N($(".enemy-card")[L.selectedCard]),x()),c(s),L.deckTop=s})),L.socket.on("gameEnded",(e=>{let a=e.wonGame;var s;if(s=e.stats,i.html(s.totalGuesses),u.html(s.correctGuesses),y.html(`${s.correctGuessRate.toFixed(2)}%`),C.html(s.timesStayed),f.html(s.wins),g.html(s.losses),p.removeClass("game-won"),p.removeClass("game-lost"),p.removeClass("tie"),h.removeClass("game-won"),h.removeClass("game-lost"),h.removeClass("tie"),s.wins>s.losses?(p.addClass("game-won"),h.addClass("game-lost")):s.wins<s.losses?(p.addClass("game-lost"),h.addClass("game-won")):(p.addClass("tie"),h.addClass("tie")),e.enemyDisconnect)return $(".game-status").html("Enemy has disconnected!"),void G(a);a?(j($(".enemy-card")),$(".game-status").html(`You guessed all of ${n}'s cards!`)):(j($(".my-card")),$(".game-status").html(`${n} guessed all your cards!`)),G(a)})),L.socket.on("rejected",(()=>{console.log("reconnect not allowed")})),L.socket.on("afk-warning",(()=>{window.location.href="/afk"})),function(e){new ClipboardJS("#copy-key",{text:function(){return`https://playalgo.com/${e}/play`}}).on("success",(e=>{e.clearSelection()}))}(v),$("#ready-button").click((()=>{L.ready?L.ready=!1:L.ready=!0,L.socket.emit("readyConfirmation",{ready:L.ready})})),$("#return-button").click((()=>{l.removeClass("modal-in"),$("header").removeClass("display-none"),$("footer").removeClass("display-none"),$(".lobby").removeClass("display-none"),setTimeout((()=>{$(".desk-wrapper").removeClass("fade-in"),$(".main-bg").addClass("fade-in")}),1e3),setTimeout((()=>{$("header").removeClass("header-out"),$("footer").removeClass("footer-out"),$(".lobby").removeClass("fade-out"),l.addClass("display-none"),$(".desk-wrapper").addClass("display-none"),$(".enemy-disconnect").html("")}),1400)})),m(),function(){const e=$(".guess-button");for(let a=0;a<12;a++)$(e[a]).click((()=>{L.myTurn&&($(e[L.myGuessValue]).removeClass("guess-button-selected"),L.myGuessValue=a,$(e[L.myGuessValue]).addClass("guess-button-selected"),L.socket.emit("buttonClicked",{buttonValue:L.myGuessValue}))}))}()}))})()})();